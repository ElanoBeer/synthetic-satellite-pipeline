# Synthetic Optical Satellite Imagery Generation Pipeline
## ğŸ“Œ Overview
This repository contains the implementation of a **synthetic data generation pipeline for optical satellite imagery**, developed as part of a research project focused on maritime surveillance. The pipeline leverages various generative models to create realistic satellite imagery, with a specific focus on maritime vessel detection and anomaly identification.
## ğŸ¯ Objectives
- Create a versatile **synthetic data generation framework** for maritime satellite imagery
- Implement and evaluate multiple generative approaches including **GANs, VAEs, and object insertion techniques**
- Generate diverse training data to improve **vessel detection performance** across varying conditions
- Simulate realistic maritime scenarios including **vessel anomalies** and challenging weather conditions

## ğŸ—ï¸ Pipeline Components
### 1ï¸âƒ£ **Data Processing & Preparation**
- **Image preprocessing**: Normalization, patching, and augmentation
- **Object extraction**: Vessel segmentation from source imagery
- **Dataset management**: Tools for organizing real and synthetic datasets (MASATI-v2, S2Ships)

### 2ï¸âƒ£ **Synthetic Generation Methods**
- **Generative models**:
    - VAE implementation for satellite imagery reconstruction
    - Wasserstein GAN with gradient penalty for satellite image generation
    - Context Encoder with PatchGAN for generative inpainting

- **Image Augmentation**:
  - Fast and effective dataset augmentation using Albumentations

- **Object insertion techniques**:
    - Context-aware vessel placement
    - Seamless cloning for realistic integration

- **Environmental simulation**:
    - Cloud generation and weather effects
    - Maritime condition variations

### 3ï¸âƒ£ **Vessel Detection & Evaluation**
- **YOLOv8 implementation**: Optimized for maritime vessel detection
- **Cross-validation frameworks**: Comprehensive testing across datasets
- **Performance metrics**: Precision, recall, and specialized maritime detection metrics

## ğŸ“‚ Repository Structure
``` 
ğŸ“¦ synthetic-satellite-pipeline
 â”£ ğŸ“‚ data                      # Dataset storage (not tracked in git)
 â”£ ğŸ“‚ evaluation                # Directory for evaluation scripts
 â”ƒ â”£ ğŸ“œ cloud_mask_generator.py # Generate cloud masks
 â”ƒ â”£ ğŸ“œ eval_cloud_obstruction.py # Evaluate simulated cloud obstruction
 â”ƒ â”£ ğŸ“œ vessel_count_eval.py    # Evaluation of object insertion counts
 â”£ ğŸ“‚ images                    # Generated imagery and evaluation thesis results
 â”£ ğŸ“‚ models                    # Model implementations
 â”ƒ â”£ ğŸ“‚ yolov8-n                # YOLOv8 vessel detection implementation
 â”ƒ â”£ ğŸ“‚ context_encoder         # Context Encoder models
 â”ƒ â”£ ğŸ“‚ wgan_gp                 # Wasserstein GAN with Gradient Penalty models
 â”ƒ â”— ğŸ“‚ vae                     # Variational Autoencoder models
 â”£ ğŸ“‚ notebooks                 # Jupyter notebooks for experiments and visualizations
 â”ƒ â”£ ğŸ“œ cv_evaluations.ipynb    # Main CV Results and visualizations
 â”ƒ â”£ ğŸ“œ eurosat_gan.ipynb       # GAN training on EuroSAT data
 â”ƒ â”£ ğŸ“œ image_augmentation_utils.ipynb # Testing utilities for image augmentation
 â”ƒ â”£ ğŸ“œ masativ2_testing.ipynb  # Exploratory data analysis and testing with Masati-v2
 â”ƒ â”£ ğŸ“œ object_exploration.ipynb # Vessel object analysis
 â”ƒ â”£ ğŸ“œ s2ships_testing.ipynb   # Exploratory data analysis and testing with S2Ships
 â”ƒ â”£ ğŸ“œ seamless_cloning.ipynb  # Object insertion experiments
 â”ƒ â”£ ğŸ“œ test_cloud_generator.ipynb # Cloud simulation testing
 â”ƒ â”£ ğŸ“œ test_pipeline_components.ipynb # Component testing
 â”ƒ â”— ğŸ“œ vae_testing.ipynb       # Extensive testing of VAE's generative capabilities
 â”£ ğŸ“‚ src                       # Core implementation
 â”ƒ â”£ ğŸ“œ basic_augmentation.py   # Data augmentation techniques
 â”ƒ â”£ ğŸ“œ cloud_generator.py      # Cloud and weather simulation
 â”ƒ â”£ ğŸ“œ detection_attempt.py    # Prior object detection attempt with other models
 â”ƒ â”£ ğŸ“œ object_insertion.py     # Vessel placement algorithms
 â”ƒ â”£ ğŸ“œ pipeline.py             # Run pre-generation pipeline
 â”ƒ â”— ğŸ“œ synthetic_generation.py # Main pipeline orchestration
 â”£ ğŸ“‚ utils                     # Utility scripts
 â”ƒ â”£ ğŸ“œ annotation_converter.py # Converting annotation formats
 â”ƒ â”£ ğŸ“œ boat_extraction.py      # Vessel extraction utilities
 â”ƒ â”£ ğŸ“œ dataset_creator.py      # Create dataset configurations
 â”ƒ â”£ ğŸ“œ image_patching.py       # Script to patch large satellite imagery
 â”— ğŸ“œ .gitignore                # Intentionally untracked files
 â”— ğŸ“œ .python-version           # Specified Python version for pyenv
 â”— ğŸ“œ pyproject.toml            # Dependencies and configurations for project
 â”— ğŸ“œ README.md                 # Project documentation
 â”— ğŸ“œ uv.lock                   # Dependency lock file generated by uv
```
## ğŸ”§ Key Features
### Vessel Extraction & Insertion
The pipeline implements sophisticated object extraction and insertion techniques to create realistic vessel placements in maritime scenes:
- Contextual vessel positioning based on water/land segmentation
- Seamless blending with background maritime environments
- Scale and orientation adjustments for realism

### Synthetic Environment Generation
Environmental variations are simulated to enhance dataset diversity:
- Cloud and atmospheric condition generation
- Maritime surface variations (waves, reflections)
- Time-of-day and seasonal variations

### YOLOv8 Vessel Detection
An optimized YOLOv8 implementation provides state-of-the-art vessel detection:
- Fine-tuned for maritime vessel detection scenarios
- Comprehensive evaluation across synthetic and real datasets
- Performance analysis with various training data combinations

## ğŸš€ Getting Started
### Requirements
The project requires Python 3.8+ and the following key dependencies:
- PyTorch
- OpenCV
- NumPy
- Matplotlib
- Ultralytics YOLOv8

### Usage Examples
#### Generating Synthetic Images
``` python
from src.synthetic_generation import SyntheticGenerator

generator = SyntheticGenerator(background_dir='data/backgrounds',
                               vessel_dir='data/vessels')
synthetic_images = generator.generate_batch(num_images=100)
```
#### Running Vessel Detection
``` python
from models.yolov8

-n.optimized_vessel_detection
import VesselDetector

detector = VesselDetector(model_path='models/yolov8-n/best.pt')
results = detector.detect('path/to/image.jpg')
```
## ğŸ“Š Results
The pipeline has demonstrated significant improvements in vessel detection performance, particularly in challenging scenarios with:
- Varied vessel types and sizes
- Adverse weather conditions
- Complex backgrounds and coastal regions

For detailed performance metrics and visualizations, see the evaluation notebooks in the repository.
## ğŸ” Future Work
Ongoing development is focused on:
- Expanding the diversity of synthetic vessel types
- Implementing more sophisticated diffusion models
- Enhancing anomaly detection capabilities
- Improving computational efficiency for large-scale dataset generation

## ğŸ“ Citation
If you use this code in your research, please cite:
``` 
@misc{synthetic-satellite-pipeline,
  author = {Beer, Elano},
  title = {Synthetic Optical Satellite Imagery Generation Pipeline},
  year = {2025},
  publisher = {GitHub},
  url = {https://github.com/ElanoBeer/synthetic-satellite-pipeline}
}
```
